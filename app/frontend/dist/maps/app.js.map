{"version":3,"names":[],"mappings":"","sources":["app.js"],"sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\nangular.module('myapp', ['ngRoute', 'ngResource', 'ngNamedRoute', 'dcbImgFallback', 'elasticsearch', 'zingchart-angularjs']).config([\"$routeProvider\", \"$locationProvider\", function ($routeProvider, $locationProvider) {\n    $locationProvider.html5Mode(true);\n    $routeProvider.otherwise({\n        redirectTo: '/'\n    });\n}]).controller('HeaderController', [\"$scope\", \"$location\", function ($scope, $location) {\n\n    $scope.isActive = function (viewLocation) {\n        return viewLocation === $location.path();\n    };\n}]).filter('startFrom', function () {\n    return function (input, start) {\n        start = +start; //parse to int\n        return input.slice(start);\n    };\n});\nrequire('./sample');\n\n},{\"./sample\":2}],2:[function(require,module,exports){\nrequire('./routes');\nrequire('./services');\nrequire('./resources');\n\n},{\"./resources\":3,\"./routes\":16,\"./services\":24}],3:[function(require,module,exports){\nrequire('./resources-config');\nrequire('./politician-resource');\nrequire('./tweet-resource');\n\n},{\"./politician-resource\":4,\"./resources-config\":5,\"./tweet-resource\":6}],4:[function(require,module,exports){\nangular.module('myapp').factory('Politician', ['$resource', function ($resource) {\n    return $resource('/api/politicians/:slug', { slug: '@slug' }, {\n        'list': { method: 'GET', isArray: true },\n        'update': { method: 'PUT' }\n    });\n}]);\n\n},{}],5:[function(require,module,exports){\nangular.module('myapp').config([\"$resourceProvider\", function ($resourceProvider) {\n    $resourceProvider.defaults.stripTrailingSlashes = false;\n}]);\n\n},{}],6:[function(require,module,exports){\nangular.module('myapp').factory('Tweet', ['$resource', function ($resource) {\n    return $resource('/api/tweet/:id/', { id: '@id' });\n}]);\n\n},{}],7:[function(require,module,exports){\nangular.module('myapp').controller('AboutController', [\"$scope\", function ($scope) {}]);\n\n},{}],8:[function(require,module,exports){\nangular.module('myapp').config([\"$routeProvider\", function ($routeProvider) {\n    $routeProvider.when('/about', {\n        name: 'about',\n        templateUrl: 'sample/routes/about/about.html',\n        controller: 'AboutController',\n        controllerAs: 'ctrl'\n    });\n}]);\n\n},{}],9:[function(require,module,exports){\nrequire('./about-controller');\nrequire('./about-routes');\n\n},{\"./about-controller\":7,\"./about-routes\":8}],10:[function(require,module,exports){\nangular.module('myapp').controller('ContactController', [\"$scope\", function ($scope) {}]);\n\n},{}],11:[function(require,module,exports){\nangular.module('myapp').config([\"$routeProvider\", function ($routeProvider) {\n    $routeProvider.when('/contact', {\n        name: 'contact',\n        templateUrl: 'sample/routes/contact/contact.html',\n        controller: 'ContactController',\n        controllerAs: 'ctrl'\n    });\n}]);\n\n},{}],12:[function(require,module,exports){\nrequire('./contact-controller');\nrequire('./contact-routes');\n\n},{\"./contact-controller\":10,\"./contact-routes\":11}],13:[function(require,module,exports){\nangular.module('myapp').controller('HomeController', [\"$scope\", \"orderByFilter\", \"Politician\", \"twitterService\", \"rssService\", function ($scope, orderByFilter, Politician, twitterService, rssService) {\n    var politicians = Politician.list();\n\n    politicians.$promise.then(function (result) {\n        $scope.orderedPoliticians = orderByFilter(result, \"-stats.total\");\n\n        twitterService.getTweets($scope.orderedPoliticians, 0).then(function (tweets) {\n            $scope.latestTweets = tweets;\n        });\n\n        rssService.getRss($scope.orderedPoliticians, 0).then(function (rss) {\n\n            for (var i = 0; i < rss.length; i++) {\n                var link = rss[i].link;\n\n                if (link.indexOf(\"www.rte.ie\") != -1) {\n                    rss[i].thumbnail_url = \"https://pbs.twimg.com/profile_images/535035010596630529/3SmYLBeN.png\";\n                } else if (link.indexOf(\"feeds.examiner.ie\") != -1) {\n                    rss[i].thumbnail_url = \"https://lh4.ggpht.com/26z1Lo63pZwjRmuK7MCGvlpbCJ4WU83hw1Jo9Xbs7MT4wxNI2dtu9l4WUlFEZ5rO5Go=w300-rw\";\n                } else if (link.indexOf(\"irishtimes\") != -1) {\n                    rss[i].thumbnail_url = \"https://dafnisonmusic.com/testimonial/the-irish-times/\";\n                } else if (link.indexOf(\"independent\") != -1) {\n                    rss[i].thumbnail_url = \"https://pbs.twimg.com/profile_images/682941663229050880/TpeLdc3V.png\";\n                } else if (link.indexOf(\"thejournal\") != -1) {\n                    rss[i].thumbnail_url = \"http://static2.businessinsider.com/image/528a259269bedd796568bc34-100/thejournalie.jpg\";\n                }\n            }\n\n            $scope.latestRss = rss;\n        });\n    });\n}]);\n\n},{}],14:[function(require,module,exports){\nangular.module('myapp').config([\"$routeProvider\", function ($routeProvider) {\n    $routeProvider.when('/', {\n        name: 'home',\n        templateUrl: 'sample/routes/home/home.html',\n        controller: 'HomeController',\n        controllerAs: 'ctrl'\n    });\n}]);\n\n},{}],15:[function(require,module,exports){\nrequire('./home-controller');\nrequire('./home-routes');\n\n},{\"./home-controller\":13,\"./home-routes\":14}],16:[function(require,module,exports){\nrequire('./home');\nrequire('./rank');\nrequire('./politician');\nrequire('./contact');\nrequire('./about');\n\nangular.module('myapp').run([\"$rootScope\", \"namedRouteService\", function ($rootScope, namedRouteService) {\n    $rootScope.$on('$routeChangeError', function (ev, current, previous, rejection) {\n        if (rejection.status === 404) {\n            alert('Not found');\n            namedRouteService.open('home');\n        }\n    });\n}]);\n\n},{\"./about\":9,\"./contact\":12,\"./home\":15,\"./politician\":17,\"./rank\":20}],17:[function(require,module,exports){\nrequire('./politician-controller');\nrequire('./politician-routes');\n\n},{\"./politician-controller\":18,\"./politician-routes\":19}],18:[function(require,module,exports){\nangular.module('myapp').controller('PoliticianController', [\"$scope\", \"PoliticianData\", \"Politician\", \"twitterService\", \"rssService\", function ($scope, PoliticianData, Politician, twitterService, rssService) {\n\n    var politicianData = new Politician(PoliticianData);\n\n    politicianData.$promise.then(function (result) {\n\n        $scope.politicianData = result;\n        $scope.myData = [123, 244, 257];\n\n        var politician = [politicianData];\n\n        twitterService.getTweets(politician, 0).then(function (tweets) {\n            $scope.latestTweets = tweets;\n        });\n\n        rssService.getRss(politician, 0).then(function (rss) {\n\n            for (var i = 0; i < rss.length; i++) {\n                var link = rss[i].link;\n\n                if (link.indexOf(\"www.rte.ie\") != -1) {\n                    rss[i].thumbnail_url = \"https://pbs.twimg.com/profile_images/535035010596630529/3SmYLBeN.png\";\n                } else if (link.indexOf(\"feeds.examiner.ie\") != -1) {\n                    rss[i].thumbnail_url = \"https://lh4.ggpht.com/26z1Lo63pZwjRmuK7MCGvlpbCJ4WU83hw1Jo9Xbs7MT4wxNI2dtu9l4WUlFEZ5rO5Go=w300-rw\";\n                } else if (link.indexOf(\"irishtimes\") != -1) {\n                    rss[i].thumbnail_url = \"https://dafnisonmusic.com/testimonial/the-irish-times/\";\n                } else if (link.indexOf(\"independent\") != -1) {\n                    rss[i].thumbnail_url = \"https://pbs.twimg.com/profile_images/682941663229050880/TpeLdc3V.png\";\n                } else if (link.indexOf(\"thejournal\") != -1) {\n                    rss[i].thumbnail_url = \"http://static2.businessinsider.com/image/528a259269bedd796568bc34-100/thejournalie.jpg\";\n                }\n            }\n\n            $scope.latestRss = rss;\n        });\n    });\n    $scope.myJson = {\n        globals: {\n            shadow: false,\n            fontFamily: \"Verdana\",\n            fontWeight: \"100\"\n        },\n        type: \"pie\",\n        backgroundColor: \"#fff\",\n\n        legend: {\n            layout: \"x5\",\n            position: \"50%\",\n            borderColor: \"transparent\",\n            marker: {\n                borderRadius: 10,\n                borderColor: \"transparent\"\n            }\n        },\n        tooltip: {\n            text: \"%v requests\"\n        },\n        plot: {\n            refAngle: \"-90\",\n            borderWidth: \"0px\",\n            valueBox: {\n                placement: \"in\",\n                text: \"%npv %\",\n                fontSize: \"15px\",\n                textAlpha: 1\n            }\n        },\n        series: [{\n            text: \"Positive\",\n            backgroundColor: \"#FA6E6E\"\n        }, {\n            text: \"Negative\",\n            backgroundColor: \"#D2D6DE\"\n        }, {\n            text: \"Neutral\",\n            backgroundColor: \"#28C2D1\"\n        }]\n    };\n}]);\n\n},{}],19:[function(require,module,exports){\nangular.module('myapp').config([\"$routeProvider\", function ($routeProvider) {\n    $routeProvider.when('/politician/:slug', {\n        name: 'politician',\n        templateUrl: 'sample/routes/politician/politician.html',\n        controller: 'PoliticianController',\n        controllerAs: 'ctrl',\n        resolve: {\n            PoliticianData: [\"Politician\", \"$route\", function (Politician, $route) {\n                var politicianData = Politician.get({\n                    slug: $route.current.params.slug\n                });\n                return politicianData.$promise;\n            }]\n        }\n    });\n}]);\n\n},{}],20:[function(require,module,exports){\nrequire('./rank-controller');\nrequire('./rank-routes');\n\n},{\"./rank-controller\":21,\"./rank-routes\":22}],21:[function(require,module,exports){\nangular.module('myapp').controller('RankController', [\"$scope\", \"Politician\", \"orderByFilter\", \"$location\", function ($scope, Politician, orderByFilter, $location) {\n    $scope.currentPage = 0;\n    $scope.pageSize = 10;\n    $scope.rankBy = \"-stats.total\";\n    $scope.politicians = Politician.list();\n\n    $scope.politicians.$promise.then(function (result) {\n        $scope.politicians = result;\n        buildPagination();\n        $scope.rank();\n        console.log($scope.politicians);\n    });\n\n    var getItems = function () {\n        var items = $scope.politicians;\n        if ($scope.query && $scope.filtered.length > 0) {\n            items = $scope.filtered;\n        }\n        return items;\n    };\n\n    var buildPagination = function () {\n\n        $scope.numberOfPages = new Array(Math.ceil(getItems().length / $scope.pageSize));\n    };\n\n    $scope.rank = function () {\n        $scope.politicians = orderByFilter($scope.politicians, $scope.rankBy);\n    };\n\n    $scope.changePage = function (page) {\n        if (page >= 0 && page <= getItems().length / $scope.pageSize) {\n            $scope.currentPage = page;\n        }\n    };\n\n    $scope.go = function (politician) {\n        $location.path('/politician/' + politician.slug);\n    };\n\n    $scope.search = function (item) {\n        var found = false;\n        var fullName = item.first_name + \" \" + item.last_name;\n        if (!$scope.query || item.first_name.toLowerCase().indexOf($scope.query.toLowerCase()) != -1 || item.last_name.toLowerCase().indexOf($scope.query.toLowerCase()) != -1 || fullName.toLowerCase().indexOf($scope.query.toLowerCase()) != -1) {\n\n            found = true;\n        }\n\n        buildPagination();\n\n        return found;\n    };\n\n    $scope.hasNext = function () {\n        return $scope.currentPage >= getItems().length / $scope.pageSize - 1;\n    };\n}]);\n\n},{}],22:[function(require,module,exports){\nangular.module('myapp').config([\"$routeProvider\", function ($routeProvider) {\n    $routeProvider.when('/rank', {\n        name: 'rank',\n        templateUrl: 'sample/routes/rank/rank.html',\n        controller: 'RankController',\n        controllerAs: 'ctrl'\n    });\n}]);\n\n},{}],23:[function(require,module,exports){\nangular.module('myapp').service('client', [\"esFactory\", \"$location\", function (esFactory, $location) {\n    return esFactory({\n        host: $location.host() + ':9200'\n    });\n}]);\n\n},{}],24:[function(require,module,exports){\nrequire('./client-service');\nrequire('./search-service');\nrequire('./twitter-service');\nrequire('./rss-service');\n\n},{\"./client-service\":23,\"./rss-service\":25,\"./search-service\":26,\"./twitter-service\":27}],25:[function(require,module,exports){\nangular.module('myapp').factory('rssService', ['searchService', function (searchService) {\n\n  var factory = {};\n\n  factory.getRss = function (politicians, offset) {\n    var query = { \"bool\": { \"should\": [] } };\n\n    var matchPlaceholder = { \"match\": { \"description\": { \"query\": \"\", \"operator\": \"and\" }\n      }\n    };\n\n    var matches = [];\n\n    for (var i = 0; i < politicians.length; i++) {\n      var match = angular.copy(matchPlaceholder);\n      match.match.description.query = politicians[i].first_name + \" \" + politicians[i].last_name;\n      matches.push(match);\n    }\n    query.bool.should = matches;\n\n    var sort = { \"published\": { \"order\": \"desc\" } };\n\n    return searchService.search(query, offset, 10, \"rss\", \"rss\", sort);\n  };\n\n  return factory;\n}]);\n\n},{}],26:[function(require,module,exports){\nangular.module('myapp').factory('searchService', ['$q', 'client', function ($q, client) {\n\n  var factory = {};\n\n  factory.search = function (query, offset, size, index, type, sort) {\n    var deferred = $q.defer();\n\n    client.search({\n      index: index,\n      type: type,\n      body: {\n        size: size,\n        from: (offset || 0) * size,\n        query: query,\n        sort: sort\n      }\n    }).then(function (result) {\n      var ii = 0,\n          hits_in,\n          hits_out = [];\n\n      hits_in = (result.hits || {}).hits || [];\n\n      for (; ii < hits_in.length; ii++) {\n        var object = hits_in[ii]._source;\n        hits_out.push(object);\n      }\n\n      deferred.resolve(hits_out);\n    }, deferred.reject);\n\n    return deferred.promise;\n  };\n\n  return factory;\n}]);\n\n},{}],27:[function(require,module,exports){\nangular.module('myapp').factory('twitterService', ['searchService', function (searchService) {\n\n  var factory = {};\n\n  factory.getTweets = function (politicians, offset) {\n    var query = { \"bool\": { \"should\": [] } };\n\n    var matchPlaceholder = { \"match\": { \"message\": { \"query\": \"\", \"operator\": \"and\" }\n      }\n    };\n\n    var matches = [];\n\n    for (var i = 0; i < politicians.length; i++) {\n      var match = angular.copy(matchPlaceholder);\n      match.match.message.query = politicians[i].first_name + \" \" + politicians[i].last_name;\n      matches.push(match);\n    }\n    query.bool.should = matches;\n\n    var sort = { \"date\": { \"order\": \"desc\" } };\n\n    return searchService.search(query, offset, 10, \"twitter\", \"tweet\", sort);\n  };\n\n  return factory;\n}]);\n\n},{}]},{},[1]);\n"],"file":"app.js","sourceRoot":"/source/"}